let json='[{\n    "type": "block",\n    "width": "100%",\n    "height": "80px",\n    "bgColor": "grey"\n},{\n    "type": "block",\n    "width": "80px",\n    "height": "80px",\n    "bgColor": "grey",\n    "borderRadius": "50%"\n},{\n    "type": "block",\n    "width": "100px",\n    "height": "100px",\n    "border": "thick solid grey"\n},{\n    "type": "block",\n    "width": "100%",\n    "height": "500px",\n    "bgColor": "#c6c3af",\n    "borderRadius": "40px"\n},{\n    "type": "block",\n    "width": "100px",\n    "height": "50px",\n    "bgColor": "#fff973",\n    "borderRadius": "100px / 50px"\n},{\n    "type": "block",\n    "width": "100%",\n    "height": "100px",\n    "bgColor": "pink"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "black",\n    "color": "white",\n    "text": "View More",\n    "fontFamily": "Courier New",\n    "fontSize": "16px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "white",\n    "color": "black",\n    "text": "Read More",\n    "fontSize": "20px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "rgb(11, 47, 91)",\n    "color": "rgb(202, 215, 231)",\n    "text": "SEND",\n    "fontFamily": "Trebuchet MS",\n    "fontSize": "20px",\n    "border": "2px solid rgb(202, 215, 231)"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "rgb(63, 118, 82)",\n    "color": "white",\n    "text": "SHOP &#8594;",\n    "fontFamily": "Cambria",\n    "fontSize": "20px",\n    "borderRadius": "40px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "white",\n    "color": "blue",\n    "text": "VIEW ALL",\n    "fontFamily": "Helvetica",\n    "fontSize": "20px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "rgb(7, 61, 81)",\n    "color": "white",\n    "text": "DOWNLOAD",\n    "fontFamily": "Helvetica",\n    "fontSize": "14px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "JOIN US",\n    "fontFamily": "Helvetica",\n    "fontSize": "14px",\n    "borderRadius": "40px"\n},{\n    "type": "button",\n    "width": "70px",\n    "height": "40px",\n    "bgColor": "pink",\n    "color": "red",\n    "text": "&#10084;",\n    "fontFamily": "Helvetica",\n    "fontSize": "40px",\n    "borderRadius": "100px"\n},{\n    "type": "button",\n    "width": "70px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#10006;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#128386;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#9742;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#9997;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#9786;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(229, 235, 250)",\n    "color": "rgb(4, 107, 254)",\n    "text": "&#10046;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px",\n    "borderRadius": "5px"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "white",\n    "color": "rgb(63, 118, 82)",\n    "text": "Apply Now",\n    "fontFamily": "Franklin Gothic Medium",\n    "fontSize": "18px",\n    "fontStyle": "italic"\n},{\n    "type": "button",\n    "width": "150px",\n    "height": "40px",\n    "bgColor": "white",\n    "color": "rgb(63, 118, 82)",\n    "text": "Featured",\n    "fontFamily": "Arial",\n    "fontSize": "18px",\n    "border": "2px solid rgb(63, 118, 82)"\n},{\n    "type": "button",\n    "width": "45px",\n    "height": "40px",\n    "bgColor": "rgb(255, 252, 204)",\n    "color": "rgb(161, 103, 7)",\n    "text": "&#62;",\n    "fontFamily": "Helvetica",\n    "fontSize": "30px"\n},{\n    "type": "button",\n    "width": "110px",\n    "height": "40px",\n    "bgColor": "rgb(255, 248, 107)",\n    "color": "black",\n    "text": "SEND",\n    "fontFamily": "Verdana",\n    "fontSize": "18px",\n    "fontWeight": "bold"\n},{\n    "type": "button",\n    "width": "110px",\n    "height": "40px",\n    "bgColor": "white",\n    "color": "rgb(12, 68, 38)",\n    "text": "BACK TO TOP",\n    "fontFamily": "Franklin Gothic Medium",\n    "fontSize": "16px"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Arial",\n    "fontFamily": "Arial"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Times New Roman",\n    "fontFamily": "Times New Roman"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Courier New",\n    "fontFamily": "Courier New"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Verdana",\n    "fontFamily": "Verdana"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Trebuchet MS",\n    "fontFamily": "Trebuchet MS"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Cambria",\n    "fontFamily": "Cambria"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Franklin Gothic Medium",\n    "fontFamily": "Franklin Gothic Medium"\n},{\n    "type": "text",\n    "fontSize": "20px",\n    "color": "#000",\n    "text": "Helvetica",\n    "fontFamily": "Helvetica"\n},{\n    "type": "text",\n    "fontSize": "16px",\n    "color": "#000",\n    "text": "Helvetica Light is an easy-to-read font, with tall and narrow letters, that works well on almost every site.",\n    "fontFamily": "Helvetica"\n},{\n    "type": "text",\n    "fontSize": "16px",\n    "color": "#000",\n    "text": "Helvetica Light is an easy-to-read font, with tall and narrow letters, that works well on almost every site.",\n    "fontFamily": "Helvetica",\n    "fontWeight": "bold"\n},{\n    "type": "text",\n    "fontSize": "16px",\n    "color": "#000",\n    "text": "Helvetica Light is an easy-to-read font, with tall and narrow letters, that works well on almost every site.",\n    "fontFamily": "Helvetica",\n    "fontStyle": "italic"\n},{\n    "type": "image",\n    "width": "150px",\n    "height": "150px",\n    "border": "1px solid #c6c3af",\n    "bgImage": "url(./img/work-together.jpg) "\n},{\n    "type": "image",\n    "width": "150px",\n    "height": "150px",\n    "border": "1px solid #c6c3af",\n    "bgImage": "url(./img/work-together.jpg) "\n},{\n    "type": "icon",\n    "width": "24px",\n    "height": "24px",\n    "border": "1px solid #c6c3af",\n    "icon": "url(./img/social/facebook.svg)",\n    "link": "https://www.facebook.com"\n},{\n    "type": "icon",\n    "width": "24px",\n    "height": "24px",\n    "border": "1px solid #c6c3af",\n    "icon": "url(./img/social/facebook.svg)",\n    "link": "https://www.facebook.com"\n}]';const leftSidebarButton=document.querySelector(".left-sidebar__button"),leftSidebarMenu=document.querySelector(".left-sidebar__menu"),leftSidebarElements=document.querySelector(".left-sidebar__elements");leftSidebarButton.addEventListener("click",(function(){leftSidebarMenu.classList.toggle("leftSidebarMenu")}));let jsonElements=JSON.parse(json),blocksArray=[],buttonsArray=[],textArray=[],imagesArray=[],iconsArray=[];for(let e of jsonElements){const t=e.type;switch(!0){case"block"==t:blocksArray.push(e);break;case"button"==t:buttonsArray.push(e);break;case"text"==t:textArray.push(e);break;case"image"==t:imagesArray.push(e);break;case"icon"==t:iconsArray.push(e)}}let categories=document.querySelectorAll(".categories__button");for(let e=0;e<categories.length;e++)categories[e].addEventListener("click",(function(e){let t=e.target;switch(!0){case t.classList.contains("left-sidebar__categories-block"):{leftSidebarElements.classList.add("menuFlexStyle");let e=blocksArray,t="";for(let n of e)t+=`<div class="element elementPreview"\n                    draggable="true"\n                    data-type="${n.type}" style="background: ${n.bgColor}; width: ${n.width}; height: ${n.height}; border: ${n.border}; bgImage: ${n.bgImage}; icon: ${n.icon}; border-radius: ${n.borderRadius}; border-left: ${n.borderLeft};border-right: ${n.borderRight}; border-bottom: ${n.borderBottom}; border-top: ${n.borderTop};\n                    "></div>`;leftSidebarElements.innerHTML=t,dragFromSidebar();break}case t.classList.contains("left-sidebar__categories-button"):{leftSidebarElements.classList.add("menuFlexStyle");let e=buttonsArray,t="";for(let n of e)t+=`<div class="element elementPreview flexible"\n                        draggable="true"\n                        contenteditable="true"\n                        data-type="${n.type}"\n                        style="background: ${n.bgColor}; width: ${n.width}; height: ${n.height}; color: ${n.color}; font-size: ${n.fontSize}; border: ${n.border}; bgImage: ${n.bgImage}; icon: ${n.icon}; link: ${n.link}; border-radius: ${n.borderRadius}; border-left: ${n.borderLeft}; border-right: ${n.borderRight}; border-bottom: ${n.borderBottom}; border-top: ${n.borderTop}; font-family: ${n.fontFamily}; font-size: ${n.fontSize}; font-style: ${n.fontStyle}; font-weight: ${n.fontWeight};\n                        ">`+(null==n.text?"":`${n.text}`)+"</div>";leftSidebarElements.innerHTML=t,dragFromSidebar();break}case t.classList.contains("left-sidebar__categories-text"):{leftSidebarElements.classList.remove("menuFlexStyle");let e=textArray,t="";for(let n of e)t+=`<div class="element elementPreview"\n                        draggable="true"\n                        contenteditable="true"\n                        data-type="${n.type}"\n                        style="color: ${n.color}; font-size: ${n.fontSize}; font-family: ${n.fontFamily}; font-weight: ${n.fontWeight}; font-style: ${n.fontStyle};\n                        ">${n.text}</div>`;leftSidebarElements.innerHTML=t,dragFromSidebar();break}case t.classList.contains("left-sidebar__categories-image"):{leftSidebarElements.classList.add("menuFlexStyle");let e=imagesArray,t="";for(let n of e)t+=`<div class="element elementPreview"\n                        draggable="true"\n                        data-type="${n.type}"\n                        style="background: ${n.bgColor}; width: ${n.width}; height: ${n.height}; border: ${n.border}; bgImage: ${n.bgImage}; link: ${n.link}; border-radius: ${n.borderRadius}; border-left: ${n.borderLeft}; border-right: ${n.borderRight}; border-bottom: ${n.borderBottom}; border-top: ${n.borderTop};\n                        "></div>`;leftSidebarElements.innerHTML=t,dragFromSidebar();break}case t.classList.contains("left-sidebar__categories-icon"):{leftSidebarElements.classList.add("menuFlexStyle");let e=iconsArray,t="";for(let n of e)t+=`<div class="element elementPreview"\n                        draggable="true"\n                        data-type="${n.type}"\n                        style="background: ${n.bgColor}; width: ${n.width}; height: ${n.height}; color: ${n.color}; font-size: ${n.fontSize}; border: ${n.border}; bgImage: ${n.bgImage}; icon: ${n.icon}; link: ${n.link}; border-radius: ${n.borderRadius}; border-left: ${n.borderLeft}; border-right: ${n.borderRight}; border-bottom: ${n.borderBottom}; border-top: ${n.borderTop};\n                        "></div>`;leftSidebarElements.innerHTML=t,dragFromSidebar();break}}}));let elementId=0;function dragFromSidebar(){let e=document.querySelectorAll(".elementPreview");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(function(e){const t=e.target.cloneNode(!0);elementId++,t.id=elementId,document.body.appendChild(t),t.classList.remove("elementPreview"),t.classList.add("elementMovable"),t.classList.add("flexible")}))}document.addEventListener("DOMContentLoaded",(function(e){let t=localStorage.getItem("login"),n=localStorage.getItem("firstname");null!=t&&(document.getElementById("wrapper__button").innerHTML=`<div>Привет, ${n}!</div><button id="buttonOut" onclick="outUser()" class="regButton">Выйти</button>`)}));let errors=[];function showReg(e){errors=[],document.getElementById("windowReg").style.display=e,document.getElementById("gray").style.display=e}function showIn(e){document.getElementById("windowIn").style.display=e,document.getElementById("gray2").style.display=e;let t=localStorage.getItem("email"),n=localStorage.getItem("pass");null!=t&&(document.querySelector("#email__in").value=t),null!=t&&(document.querySelector("#pass__in").value=n)}function checkValidity(e){let t=e.validity;return console.log(t.valueMissing),t.valueMissing&&errors.push("Поле "+e.placeholder+" не заполнено"),t.patternMismatch&&errors.push("Не верный формат заполнения e-mail"),errors}function checkPassword(){let e=document.querySelector("#pass1").value,t=document.querySelector("#pass2").value;return console.log(e),null!=e&&(e.length<4&&errors.push("Минимальное значение пароля не может быть меньше, чем 4"),e.length>10&&errors.push("Максимальное значение пароля не может быть больше, чем 10"),-1===e.search(/[a-z]/)&&errors.push("Пароль должен содержать минимум одну прописную букву"),-1===e.search(/[A-Z]/)&&errors.push("Пароль должен содержать минимум одну заглавную букву"),-1===e.search(/[0123456789]/)&&errors.push("Пароль должен содержать минимум одну цифру"),e!=t&&errors.push("Пароль не совпадает!")),errors}function pushReg(){let e=document.querySelectorAll(".inputReg");console.log(e);for(let t of e)checkValidity(t);checkPassword(),0==errors?saveData():(document.getElementById("error").innerHTML=errors.join(".<br>"),errors=[]),document.querySelector("form").addEventListener("submit",(e=>e.preventDefault()))}function saveData(){let e=document.querySelector("#firstname").value,t=document.querySelector("#lastname").value,n=document.querySelector("#email").value,o=document.querySelector("#pass1").value,r=document.querySelector("#pass2").value;console.log(o,r),document.querySelector(".error").innerHTML="",null==localStorage.getItem("firstName")&&localStorage.setItem("firstname",e),null==localStorage.getItem("lastname")&&localStorage.setItem("lastname",t),null==localStorage.getItem("email")&&localStorage.setItem("email",n),null==localStorage.getItem("pass")&&localStorage.setItem("pass",r),localStorage.setItem("login",!0),document.getElementById("windowReg").style.display="none",document.getElementById("gray").style.display="none",document.querySelector("form").addEventListener("submit",(e=>e.preventDefault())),document.getElementById("wrapper__button").innerHTML=`<div>Привет, ${e}!</div><button id="buttonOut" onclick="outUser()" class="regButton">Выйти</button>`}function getIn(){document.querySelector("#inForm").addEventListener("submit",(e=>e.preventDefault())),document.getElementById("windowIn").style.display="none",document.getElementById("gray2").style.display="none",document.getElementById("wrapper__button").innerHTML=`<div>Привет, ${localStorage.getItem("firstname")}!</div><button id="buttonOut" onclick="outUser()" class="regButton">Выйти</button>`,localStorage.setItem("login",!0)}function outUser(){document.getElementById("wrapper__button").innerHTML='<button id="buttonReg" onclick="showReg(\'block\')" class="regButton">Регистрация</button>\n    <button id="buttonIn" onclick="showIn(\'block\')" class="regButton">Войти</button>',localStorage.removeItem("login")}const dragAndDrop=()=>{const e=document.querySelector(".menu"),t=document.querySelector(".template");let n=0;class o{constructor(e,t){this.type=e,this.classes=t}duplicate(){}showMenu(){}delete(){}saveToLS(){let e=[],t=null;localStorage.getItem("template")?(t=JSON.parse(localStorage.getItem("template")),t.length>1?e.push(...t,this):e.push(t,this),localStorage.setItem("template",JSON.stringify(e))):localStorage.setItem("template",JSON.stringify(this))}}class r extends o{constructor(e,t,n,o,r,l){super(e,t),this.width=n,this.height=o,this.posX=r,this.posY=l}changeHeight(){}changeWidth(){}changePosX(){}changePosY(){}}class l extends o{constructor(e,t,o){super(e,t),this.bgColor=o,this.templateInd=n++}setTemplateInd(){}setBackgroundColor(){}}class i extends r{constructor(e,t,n,o,r,l,i,a,s){super(e,t,n,o,r,l),this.bgColor=i,this.btnLabel=a,this.fontColor=s}setBackgroundColor(){}setBtnLabel(){}setFontColor(){}}const a=document.querySelectorAll(".menu__element");let s=!1,d=null,c=0,g=0;const b=function(n){console.log("drag start"),setTimeout((()=>{n.target.parentNode===e?d=n.target.cloneNode(!0):n.target.parentNode===t&&(d=n.target)}))},u=function(e){},p=function(e){s=!1,console.log("from menu"),g=e.offsetY,c=e.offsetX},m=function(e){console.log("from template"),console.log(`e.client: ${e.clientY},${e.clientX}`),console.log(e),console.log("offset E: "+e.offsetY,e.offsetX),console.log("offset: "+e.target.offsetTop,e.target.offsetLeft),s=!0,g=e.offsetY,c=e.offsetX};a.forEach((e=>{e.addEventListener("dragstart",b),e.addEventListener("dragend",u),e.addEventListener("mousedown",p)})),t.addEventListener("dragover",(function(e){e.preventDefault()})),t.addEventListener("dragenter",(function(e){e.preventDefault()})),t.addEventListener("drop",(function(e){e.preventDefault(),console.log("drag drop"),console.log(d),this.append(d),d.classList.remove("menu__element"),d.classList.add("template__element"),d.removeEventListener("mousedown",p),d.addEventListener("mousedown",m),d.addEventListener("dragstart",b),s?(d.style.top=e.clientY-g+"px",d.style.left=e.clientX-c+"px"):function(e,t){const n=t.dataset.type;let o=null;"block"===n?(t.classList.add("wide"),o=new l(n,t.classList,t.style.backgroundColor),o.saveToLS()):(t.classList.add("draggable-element"),t.style.top=e.layerY-g+"px",t.style.left=e.layerX-c+"px","button"===n&&(o=new i(n,t.classList,t.clientWidth,t.clientHeight,t.style.left,t.style.top,t.style.backgroundColor,t.innerHTML,t.style.color),o.saveToLS()))}(e,d)}))};dragAndDrop();